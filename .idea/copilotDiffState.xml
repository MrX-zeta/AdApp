<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/AdApp-Backend/src/main/kotlin/com/adapp/backend/Application.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/AdApp-Backend/src/main/kotlin/com/adapp/backend/Application.kt" />
              <option name="originalContent" value="package com.adapp.backend&#10;&#10;import com.adapp.backend.Event.Infrastructure.Routes.configureEventRouting&#10;import com.adapp.backend.Follower.Infrastructure.Routes.configureFollowerRouting&#10;import com.adapp.backend.Shared.Infrastructure.Plugins.configureSerialization&#10;import com.adapp.backend.Song.Infrastructure.Routes.configureSongRouting&#10;import com.adapp.backend.User.Infrastructure.Routes.configureRouting as configureUserRouting&#10;import com.adapp.backend.Artist.Infrastructure.Routes.configureArtistRouting as configureArtistRouting&#10;import com.adapp.backend.SocialMedia.Infrastructure.Routes.configureRouting as configureSocialMediaRouting&#10;import com.adapp.backend.User.Infrastructure.Repositories.InMemoryUserRepository&#10;import com.adapp.backend.Artist.Infrastructure.Repositories.InMemoryArtistRepository&#10;import com.adapp.backend.SocialMedia.Infrastructure.Repositories.InMemorySocialMediaRepository&#10;&#10;import io.ktor.server.application.*&#10;import io.ktor.server.netty.EngineMain&#10;&#10;fun main(args: Array&lt;String&gt;) {&#10;    // Evitar que Netty use sun.misc.Unsafe en JDKs modernos (suprime warnings y llamadas a Unsafe)&#10;    System.setProperty(&quot;io.netty.noUnsafe&quot;, &quot;true&quot;)&#10;    System.setProperty(&quot;io.netty.tryReflectionSetAccessible&quot;, &quot;false&quot;)&#10;    EngineMain.main(args)&#10;}&#10;&#10;fun Application.module() {&#10;    // Crear repositorios compartidos una sola vez para toda la aplicación&#10;    val userRepo = InMemoryUserRepository()&#10;    val artistRepo = InMemoryArtistRepository()&#10;    val socialMediaRepo = InMemorySocialMediaRepository()&#10;&#10;    configureSerialization()&#10;    configureUserRouting(userRepo, artistRepo)&#10;    configureArtistRouting(artistRepo, socialMediaRepo)&#10;    configureFollowerRouting()&#10;    configureEventRouting()&#10;    configureSongRouting()&#10;    configureSocialMediaRouting(socialMediaRepo)&#10;}&#10;" />
              <option name="updatedContent" value="package com.adapp.backend&#10;&#10;import com.adapp.backend.Event.Infrastructure.Routes.configureEventRouting&#10;import com.adapp.backend.Follower.Infrastructure.Routes.configureFollowerRouting&#10;import com.adapp.backend.Shared.Infrastructure.Plugins.configureSerialization&#10;import com.adapp.backend.Song.Infrastructure.Routes.configureSongRouting&#10;import com.adapp.backend.User.Infrastructure.Routes.configureRouting as configureUserRouting&#10;import com.adapp.backend.Artist.Infrastructure.Routes.configureArtistRouting as configureArtistRouting&#10;import com.adapp.backend.SocialMedia.Infrastructure.Routes.configureRouting as configureSocialMediaRouting&#10;import com.adapp.examples.configureFrameworks&#10;&#10;import io.ktor.server.application.*&#10;import io.ktor.server.netty.EngineMain&#10;&#10;fun main(args: Array&lt;String&gt;) {&#10;    // Evitar que Netty use sun.misc.Unsafe en JDKs modernos (suprime warnings y llamadas a Unsafe)&#10;    System.setProperty(&quot;io.netty.noUnsafe&quot;, &quot;true&quot;)&#10;    System.setProperty(&quot;io.netty.tryReflectionSetAccessible&quot;, &quot;false&quot;)&#10;    EngineMain.main(args)&#10;}&#10;&#10;fun Application.module() {&#10;    // Configurar Koin (inyección de dependencias)&#10;    configureFrameworks()&#10;    &#10;    // Configurar plugins&#10;    configureSerialization()&#10;    &#10;    // Configurar rutas (los repositorios se inyectan automáticamente con Koin)&#10;    configureUserRouting()&#10;    configureArtistRouting()&#10;    configureFollowerRouting()&#10;    configureEventRouting()&#10;    configureSongRouting()&#10;    configureSocialMediaRouting()&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/AdApp-Backend/src/main/kotlin/com/adapp/backend/Artist/Infrastructure/Routes/KtorArtistRouting.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/AdApp-Backend/src/main/kotlin/com/adapp/backend/Artist/Infrastructure/Routes/KtorArtistRouting.kt" />
              <option name="originalContent" value="package com.adapp.backend.Artist.Infrastructure.Routes&#10;&#10;import com.adapp.backend.Artist.Infrastructure.Repositories.InMemoryArtistRepository&#10;import com.adapp.backend.Artist.Infrastructure.Controllers.KtorArtistController&#10;import com.adapp.backend.SocialMedia.Infrastructure.Repositories.InMemorySocialMediaRepository&#10;import com.adapp.backend.SocialMedia.Domain.Models.SocialMedia&#10;import com.adapp.backend.SocialMedia.Domain.Models.SocialMediaId&#10;import com.adapp.backend.SocialMedia.Domain.Models.SocialMediaUrl&#10;import com.adapp.backend.User.Domain.Models.UserId&#10;import com.adapp.backend.User.Domain.Exceptions.UserNotFoundError&#10;import io.ktor.http.*&#10;import io.ktor.server.application.*&#10;import io.ktor.server.routing.*&#10;import io.ktor.server.response.*&#10;import io.ktor.server.request.*&#10;import kotlinx.serialization.Serializable&#10;&#10;fun Application.configureArtistRouting(&#10;    repo: InMemoryArtistRepository,&#10;    socialMediaRepo: InMemorySocialMediaRepository&#10;){&#10;    // Usar repositorio compartido recibido como parámetro&#10;    val controller = KtorArtistController(repo)&#10;&#10;    routing {&#10;        // Alias plural para compatibilidad&#10;        get(&quot;/artists&quot;){&#10;            try{&#10;                val artists = controller.getAll()&#10;                call.respond(artists)&#10;            }catch(e: Exception){&#10;                call.application.environment.log.error(&quot;Error in GET /artists&quot;, e)&#10;                call.respond(HttpStatusCode.InternalServerError, mapOf(&quot;message&quot; to (e.message ?: &quot;&quot;)))&#10;            }&#10;        }&#10;&#10;        get(&quot;/artist/{id}/&quot;){&#10;            val idParam = call.parameters[&quot;id&quot;]&#10;            if(idParam == null){&#10;                call.respond(HttpStatusCode.BadRequest, mapOf(&quot;message&quot; to &quot;Missing id&quot;))&#10;                return@get&#10;            }&#10;            val id = idParam.toIntOrNull()&#10;            if(id == null){&#10;                call.respond(HttpStatusCode.BadRequest, mapOf(&quot;message&quot; to &quot;Invalid id&quot;))&#10;                return@get&#10;            }&#10;&#10;            try{&#10;                val artist = controller.getOneById(id)&#10;                call.respond(artist)&#10;            }catch(e: UserNotFoundError){&#10;                call.respond(HttpStatusCode.NotFound, mapOf(&quot;message&quot; to e.message))&#10;            }&#10;        }&#10;&#10;        post(&quot;/artist/&quot;){&#10;            val payload = call.receive&lt;CreateArtistRequest&gt;()&#10;            controller.create(payload.id, payload.nombre, payload.correo, payload.contrasena, payload.rol, payload.fotoUrl, payload.contactNum, payload.description ?: &quot;&quot;)&#10;            call.respond(HttpStatusCode.Created, mapOf(&quot;message&quot; to &quot;Artist created&quot;))&#10;        }&#10;&#10;        put(&quot;/artist/{id}/&quot;){&#10;            val idParam = call.parameters[&quot;id&quot;]&#10;            if(idParam == null){&#10;                call.respond(HttpStatusCode.BadRequest, mapOf(&quot;message&quot; to &quot;Missing id&quot;))&#10;                return@put&#10;            }&#10;            val oldId = idParam.toIntOrNull()&#10;            if(oldId == null){&#10;                call.respond(HttpStatusCode.BadRequest, mapOf(&quot;message&quot; to &quot;Invalid id&quot;))&#10;                return@put&#10;            }&#10;&#10;            val payload = call.receive&lt;EditArtistRequest&gt;()&#10;            try{&#10;                controller.edit(oldId, payload.id, payload.nombre, payload.correo, payload.contrasena, payload.rol, payload.fotoUrl, payload.contactNum, payload.description ?: &quot;&quot;)&#10;&#10;                // Manejar redes sociales&#10;                val artistId = payload.id&#10;&#10;                // Helper para generar siguiente ID (recalcula cada vez)&#10;                fun nextId(): Int {&#10;                    val currentSocialMedia = socialMediaRepo.getAllSM()&#10;                    val max = currentSocialMedia.maxOfOrNull { it.SocialMediaId.value } ?: 0&#10;                    return max + 1&#10;                }&#10;&#10;                // Instagram&#10;                val instagramEntry = socialMediaRepo.getAllSM().find {&#10;                    it.artistId.value == artistId &amp;&amp; it.url.value.startsWith(&quot;instagram:&quot;, ignoreCase = true)&#10;                }&#10;                if (!payload.instagram.isNullOrBlank()) {&#10;                    val url = &quot;instagram:${payload.instagram.trim()}&quot;&#10;                    if (instagramEntry != null) {&#10;                        socialMediaRepo.edit(SocialMedia(instagramEntry.SocialMediaId, instagramEntry.artistId, SocialMediaUrl(url)))&#10;                    } else {&#10;                        socialMediaRepo.create(SocialMedia(SocialMediaId(nextId()), UserId(artistId), SocialMediaUrl(url)))&#10;                    }&#10;                } else if (instagramEntry != null) {&#10;                    socialMediaRepo.delete(instagramEntry.SocialMediaId)&#10;                }&#10;&#10;                // Facebook&#10;                val facebookEntry = socialMediaRepo.getAllSM().find {&#10;                    it.artistId.value == artistId &amp;&amp; it.url.value.startsWith(&quot;facebook:&quot;, ignoreCase = true)&#10;                }&#10;                if (!payload.facebook.isNullOrBlank()) {&#10;                    val url = &quot;facebook:${payload.facebook.trim()}&quot;&#10;                    if (facebookEntry != null) {&#10;                        socialMediaRepo.edit(SocialMedia(facebookEntry.SocialMediaId, facebookEntry.artistId, SocialMediaUrl(url)))&#10;                    } else {&#10;                        socialMediaRepo.create(SocialMedia(SocialMediaId(nextId()), UserId(artistId), SocialMediaUrl(url)))&#10;                    }&#10;                } else if (facebookEntry != null) {&#10;                    socialMediaRepo.delete(facebookEntry.SocialMediaId)&#10;                }&#10;&#10;                call.respond(HttpStatusCode.NoContent)&#10;            }catch(e: UserNotFoundError){&#10;                call.respond(HttpStatusCode.NotFound, mapOf(&quot;message&quot; to e.message))&#10;            }catch(e: IllegalArgumentException){&#10;                call.respond(HttpStatusCode.BadRequest, mapOf(&quot;message&quot; to e.message))&#10;            }&#10;        }&#10;&#10;        delete(&quot;/artist/{id}&quot;){&#10;            val idParam = call.parameters[&quot;id&quot;]&#10;            if(idParam == null){&#10;                call.respond(HttpStatusCode.BadRequest, mapOf(&quot;message&quot; to &quot;Missing id&quot;))&#10;                return@delete&#10;            }&#10;            val id = idParam.toIntOrNull()&#10;            if(id == null){&#10;                call.respond(HttpStatusCode.BadRequest, mapOf(&quot;message&quot; to &quot;Invalid id&quot;))&#10;                return@delete&#10;            }&#10;            try{&#10;                controller.delete(id)&#10;                call.respond(HttpStatusCode.NoContent)&#10;            }catch(e: UserNotFoundError){&#10;                call.respond(HttpStatusCode.NotFound, mapOf(&quot;message&quot; to e.message))&#10;            }&#10;        }&#10;    }&#10;}&#10;&#10;@Serializable&#10;private data class CreateArtistRequest(&#10;    val id: Int,&#10;    val nombre: String,&#10;    val correo: String,&#10;    val contrasena: String,&#10;    val rol: String,&#10;    val fotoUrl: String,&#10;    val contactNum: String,&#10;    val instagram: String? = null,&#10;    val facebook: String? = null,&#10;    val description: String? = null&#10;)&#10;&#10;@Serializable&#10;private data class EditArtistRequest(&#10;    val id: Int,&#10;    val nombre: String,&#10;    val correo: String,&#10;    val contrasena: String,&#10;    val rol: String,&#10;    val fotoUrl: String,&#10;    val contactNum: String,&#10;    val instagram: String? = null,&#10;    val facebook: String? = null,&#10;    val description: String? = null&#10;)&#10;" />
              <option name="updatedContent" value="package com.adapp.backend.Artist.Infrastructure.Routes&#10;&#10;import com.adapp.backend.Artist.Infrastructure.Repositories.InMemoryArtistRepository&#10;import com.adapp.backend.Artist.Infrastructure.Controllers.KtorArtistController&#10;import com.adapp.backend.SocialMedia.Infrastructure.Repositories.InMemorySocialMediaRepository&#10;import com.adapp.backend.SocialMedia.Domain.Models.SocialMedia&#10;import com.adapp.backend.SocialMedia.Domain.Models.SocialMediaId&#10;import com.adapp.backend.SocialMedia.Domain.Models.SocialMediaUrl&#10;import com.adapp.backend.User.Domain.Models.UserId&#10;import com.adapp.backend.User.Domain.Exceptions.UserNotFoundError&#10;import io.ktor.http.*&#10;import io.ktor.server.application.*&#10;import io.ktor.server.routing.*&#10;import io.ktor.server.response.*&#10;import io.ktor.server.request.*&#10;import kotlinx.serialization.Serializable&#10;import org.koin.ktor.ext.inject&#10;&#10;fun Application.configureArtistRouting(){&#10;    // Inyectar repositorios usando Koin&#10;    val repo: InMemoryArtistRepository by inject()&#10;    val socialMediaRepo: InMemorySocialMediaRepository by inject()&#10;    &#10;    val controller = KtorArtistController(repo)&#10;&#10;    routing {&#10;        // Alias plural para compatibilidad&#10;        get(&quot;/artists&quot;){&#10;            try{&#10;                val artists = controller.getAll()&#10;                call.respond(artists)&#10;            }catch(e: Exception){&#10;                call.application.environment.log.error(&quot;Error in GET /artists&quot;, e)&#10;                call.respond(HttpStatusCode.InternalServerError, mapOf(&quot;message&quot; to (e.message ?: &quot;&quot;)))&#10;            }&#10;        }&#10;&#10;        get(&quot;/artist/{id}/&quot;){&#10;            val idParam = call.parameters[&quot;id&quot;]&#10;            if(idParam == null){&#10;                call.respond(HttpStatusCode.BadRequest, mapOf(&quot;message&quot; to &quot;Missing id&quot;))&#10;                return@get&#10;            }&#10;            val id = idParam.toIntOrNull()&#10;            if(id == null){&#10;                call.respond(HttpStatusCode.BadRequest, mapOf(&quot;message&quot; to &quot;Invalid id&quot;))&#10;                return@get&#10;            }&#10;&#10;            try{&#10;                val artist = controller.getOneById(id)&#10;                call.respond(artist)&#10;            }catch(e: UserNotFoundError){&#10;                call.respond(HttpStatusCode.NotFound, mapOf(&quot;message&quot; to e.message))&#10;            }&#10;        }&#10;&#10;        post(&quot;/artist/&quot;){&#10;            val payload = call.receive&lt;CreateArtistRequest&gt;()&#10;            controller.create(payload.id, payload.nombre, payload.correo, payload.contrasena, payload.rol, payload.fotoUrl, payload.contactNum, payload.description ?: &quot;&quot;)&#10;            call.respond(HttpStatusCode.Created, mapOf(&quot;message&quot; to &quot;Artist created&quot;))&#10;        }&#10;&#10;        put(&quot;/artist/{id}/&quot;){&#10;            val idParam = call.parameters[&quot;id&quot;]&#10;            if(idParam == null){&#10;                call.respond(HttpStatusCode.BadRequest, mapOf(&quot;message&quot; to &quot;Missing id&quot;))&#10;                return@put&#10;            }&#10;            val oldId = idParam.toIntOrNull()&#10;            if(oldId == null){&#10;                call.respond(HttpStatusCode.BadRequest, mapOf(&quot;message&quot; to &quot;Invalid id&quot;))&#10;                return@put&#10;            }&#10;&#10;            val payload = call.receive&lt;EditArtistRequest&gt;()&#10;            try{&#10;                controller.edit(oldId, payload.id, payload.nombre, payload.correo, payload.contrasena, payload.rol, payload.fotoUrl, payload.contactNum, payload.description ?: &quot;&quot;)&#10;&#10;                // Manejar redes sociales&#10;                val artistId = payload.id&#10;&#10;                // Helper para generar siguiente ID (recalcula cada vez)&#10;                fun nextId(): Int {&#10;                    val currentSocialMedia = socialMediaRepo.getAllSM()&#10;                    val max = currentSocialMedia.maxOfOrNull { it.SocialMediaId.value } ?: 0&#10;                    return max + 1&#10;                }&#10;&#10;                // Instagram&#10;                val instagramEntry = socialMediaRepo.getAllSM().find {&#10;                    it.artistId.value == artistId &amp;&amp; it.url.value.startsWith(&quot;instagram:&quot;, ignoreCase = true)&#10;                }&#10;                if (!payload.instagram.isNullOrBlank()) {&#10;                    val url = &quot;instagram:${payload.instagram.trim()}&quot;&#10;                    if (instagramEntry != null) {&#10;                        socialMediaRepo.edit(SocialMedia(instagramEntry.SocialMediaId, instagramEntry.artistId, SocialMediaUrl(url)))&#10;                    } else {&#10;                        socialMediaRepo.create(SocialMedia(SocialMediaId(nextId()), UserId(artistId), SocialMediaUrl(url)))&#10;                    }&#10;                } else if (instagramEntry != null) {&#10;                    socialMediaRepo.delete(instagramEntry.SocialMediaId)&#10;                }&#10;&#10;                // Facebook&#10;                val facebookEntry = socialMediaRepo.getAllSM().find {&#10;                    it.artistId.value == artistId &amp;&amp; it.url.value.startsWith(&quot;facebook:&quot;, ignoreCase = true)&#10;                }&#10;                if (!payload.facebook.isNullOrBlank()) {&#10;                    val url = &quot;facebook:${payload.facebook.trim()}&quot;&#10;                    if (facebookEntry != null) {&#10;                        socialMediaRepo.edit(SocialMedia(facebookEntry.SocialMediaId, facebookEntry.artistId, SocialMediaUrl(url)))&#10;                    } else {&#10;                        socialMediaRepo.create(SocialMedia(SocialMediaId(nextId()), UserId(artistId), SocialMediaUrl(url)))&#10;                    }&#10;                } else if (facebookEntry != null) {&#10;                    socialMediaRepo.delete(facebookEntry.SocialMediaId)&#10;                }&#10;&#10;                call.respond(HttpStatusCode.NoContent)&#10;            }catch(e: UserNotFoundError){&#10;                call.respond(HttpStatusCode.NotFound, mapOf(&quot;message&quot; to e.message))&#10;            }catch(e: IllegalArgumentException){&#10;                call.respond(HttpStatusCode.BadRequest, mapOf(&quot;message&quot; to e.message))&#10;            }&#10;        }&#10;&#10;        delete(&quot;/artist/{id}&quot;){&#10;            val idParam = call.parameters[&quot;id&quot;]&#10;            if(idParam == null){&#10;                call.respond(HttpStatusCode.BadRequest, mapOf(&quot;message&quot; to &quot;Missing id&quot;))&#10;                return@delete&#10;            }&#10;            val id = idParam.toIntOrNull()&#10;            if(id == null){&#10;                call.respond(HttpStatusCode.BadRequest, mapOf(&quot;message&quot; to &quot;Invalid id&quot;))&#10;                return@delete&#10;            }&#10;            try{&#10;                controller.delete(id)&#10;                call.respond(HttpStatusCode.NoContent)&#10;            }catch(e: UserNotFoundError){&#10;                call.respond(HttpStatusCode.NotFound, mapOf(&quot;message&quot; to e.message))&#10;            }&#10;        }&#10;    }&#10;}&#10;&#10;@Serializable&#10;private data class CreateArtistRequest(&#10;    val id: Int,&#10;    val nombre: String,&#10;    val correo: String,&#10;    val contrasena: String,&#10;    val rol: String,&#10;    val fotoUrl: String,&#10;    val contactNum: String,&#10;    val instagram: String? = null,&#10;    val facebook: String? = null,&#10;    val description: String? = null&#10;)&#10;&#10;@Serializable&#10;private data class EditArtistRequest(&#10;    val id: Int,&#10;    val nombre: String,&#10;    val correo: String,&#10;    val contrasena: String,&#10;    val rol: String,&#10;    val fotoUrl: String,&#10;    val contactNum: String,&#10;    val instagram: String? = null,&#10;    val facebook: String? = null,&#10;    val description: String? = null&#10;)&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/AdApp-Backend/src/main/kotlin/com/adapp/backend/Shared/Infrastructure/DI/AppModule.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/AdApp-Backend/src/main/kotlin/com/adapp/backend/Shared/Infrastructure/DI/AppModule.kt" />
              <option name="updatedContent" value="package com.adapp.backend.Shared.Infrastructure.DI&#10;&#10;import com.adapp.backend.User.Infrastructure.Repositories.InMemoryUserRepository&#10;import com.adapp.backend.Artist.Infrastructure.Repositories.InMemoryArtistRepository&#10;import com.adapp.backend.SocialMedia.Infrastructure.Repositories.InMemorySocialMediaRepository&#10;import org.koin.dsl.module&#10;&#10;val repositoryModule = module {&#10;    // Repositorios como singletons compartidos&#10;    single { InMemoryUserRepository() }&#10;    single { InMemoryArtistRepository() }&#10;    single { InMemorySocialMediaRepository() }&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/AdApp-Backend/src/main/kotlin/com/adapp/backend/Shared/Infrastructure/Plugins/Frameworks.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/AdApp-Backend/src/main/kotlin/com/adapp/backend/Shared/Infrastructure/Plugins/Frameworks.kt" />
              <option name="originalContent" value="package com.adapp.examples&#10;&#10;import io.ktor.server.application.*&#10;import org.koin.dsl.module&#10;import org.koin.ktor.plugin.Koin&#10;import org.koin.logger.slf4jLogger&#10;&#10;fun Application.configureFrameworks() {&#10;    install(Koin) {&#10;        slf4jLogger()&#10;        modules(module {&#10;            single&lt;HelloService&gt; {&#10;                HelloService {&#10;                    println(environment.log.info(&quot;Hello, World!&quot;))&#10;                }&#10;            }&#10;        })&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package com.adapp.examples&#10;&#10;import com.adapp.backend.Shared.Infrastructure.DI.repositoryModule&#10;import io.ktor.server.application.*&#10;import org.koin.dsl.module&#10;import org.koin.ktor.plugin.Koin&#10;import org.koin.logger.slf4jLogger&#10;&#10;fun Application.configureFrameworks() {&#10;    install(Koin) {&#10;        slf4jLogger()&#10;        modules(&#10;            module {&#10;                single&lt;HelloService&gt; {&#10;                    HelloService {&#10;                        println(environment.log.info(&quot;Hello, World!&quot;))&#10;                    }&#10;                }&#10;            },&#10;            repositoryModule // Módulo de repositorios&#10;        )&#10;    }&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/AdApp-Backend/src/main/kotlin/com/adapp/backend/SocialMedia/Infrastructure/Routes/KtorSocialMediaRouting.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/AdApp-Backend/src/main/kotlin/com/adapp/backend/SocialMedia/Infrastructure/Routes/KtorSocialMediaRouting.kt" />
              <option name="originalContent" value="package com.adapp.backend.SocialMedia.Infrastructure.Routes&#10;&#10;import com.adapp.backend.SocialMedia.Domain.Exceptions.SocialMediaNotFoundError&#10;import com.adapp.backend.SocialMedia.Infrastructure.Controllers.KtorSocialMediaController&#10;import com.adapp.backend.SocialMedia.Infrastructure.Repositories.InMemorySocialMediaRepository&#10;import io.ktor.http.HttpStatusCode&#10;import io.ktor.server.application.Application&#10;import io.ktor.server.request.receive&#10;import io.ktor.server.response.respond&#10;import io.ktor.server.routing.delete&#10;import io.ktor.server.routing.get&#10;import io.ktor.server.routing.post&#10;import io.ktor.server.routing.put&#10;import io.ktor.server.routing.routing&#10;import kotlinx.serialization.Serializable&#10;&#10;fun Application.configureRouting(SMRepo: InMemorySocialMediaRepository){&#10;    // Usar repositorio compartido recibido como parámetro&#10;    val controller = KtorSocialMediaController(SMRepo)&#10;&#10;    routing {&#10;        get(&quot;/sm&quot;){&#10;            try {&#10;                val socialMedias = controller.getAll()&#10;                call.respond(socialMedias)&#10;            }catch (e:Exception){&#10;                call.application.environment.log.error(&quot;Error in GET /sm&quot;, e)&#10;                call.respond(HttpStatusCode.InternalServerError, mapOf(&quot;message&quot; to (e.message ?: &quot;&quot;)))&#10;            }&#10;        }&#10;&#10;        get(&quot;/sm/{id}&quot;){&#10;            val idParam = call.parameters[&quot;id&quot;]&#10;            if(idParam == null){&#10;                call.respond(HttpStatusCode.BadRequest, mapOf(&quot;message&quot; to &quot;Missing id&quot;))&#10;                return@get&#10;            }&#10;            val id = idParam.toIntOrNull()&#10;            if(id == null){&#10;                call.respond(HttpStatusCode.BadRequest, mapOf(&quot;message&quot; to &quot;Invalid id&quot;))&#10;                return@get&#10;            }&#10;&#10;            try{&#10;                val socialMedia = controller.getOneById(id)&#10;                call.respond(HttpStatusCode.OK, socialMedia)&#10;            }catch (e: SocialMediaNotFoundError){&#10;                call.respond(HttpStatusCode.NotFound, mapOf(&quot;message&quot; to e.toString()))&#10;            }&#10;        }&#10;&#10;        get(&quot;/socialMedia/artist/{artistId}/&quot;){&#10;            val artistIdParam = call.parameters[&quot;artistId&quot;]&#10;            if(artistIdParam == null){&#10;                call.respond(HttpStatusCode.BadRequest, mapOf(&quot;message&quot; to &quot;Missing artistId&quot;))&#10;                return@get&#10;            }&#10;            val artistId = artistIdParam.toIntOrNull()&#10;            if(artistId == null){&#10;                call.respond(HttpStatusCode.BadRequest, mapOf(&quot;message&quot; to &quot;Invalid artistId&quot;))&#10;                return@get&#10;            }&#10;&#10;            try{&#10;                val socialMedias = controller.getByArtistId(artistId)&#10;                call.respond(HttpStatusCode.OK, socialMedias)&#10;            }catch(e: Exception){&#10;                call.application.environment.log.error(&quot;Error in GET /socialMedia/artist/{artistId}/&quot;, e)&#10;                call.respond(HttpStatusCode.InternalServerError, mapOf(&quot;message&quot; to (e.message ?: &quot;&quot;)))&#10;            }&#10;        }&#10;&#10;        post(&quot;/sm/&quot;){&#10;            val payload = call.receive&lt;CreateSMRequest&gt;()&#10;            controller.create(payload.id, payload.artistId, payload.url)&#10;        }&#10;&#10;        put(&quot;/sm/{id}/&quot;){&#10;            val idParam = call.parameters[&quot;id&quot;]&#10;            if (idParam == null){&#10;                call.respond(HttpStatusCode.BadRequest, mapOf(&quot;message&quot; to &quot;Missing id&quot;))&#10;                return@put&#10;            }&#10;            val oldId = idParam.toIntOrNull()&#10;            if (oldId == null){&#10;                call.respond(HttpStatusCode.BadRequest, mapOf(&quot;message&quot; to &quot;Invalid id&quot;))&#10;                return@put&#10;            }&#10;            val payload = call.receive&lt;EditSMRequest&gt;()&#10;            try {&#10;                controller.edit(oldId, payload.id, payload.artistId.toInt(), payload.url)&#10;            }catch (e: SocialMediaNotFoundError){&#10;                call.respond(HttpStatusCode.NotFound, mapOf(&quot;message&quot; to e.toString()))&#10;            }catch (e: IllegalArgumentException){&#10;                call.respond(HttpStatusCode.Conflict, mapOf(&quot;message&quot; to e.message.toString()))&#10;            }&#10;        }&#10;&#10;        delete(&quot;/sm/{id}&quot;){&#10;            val idParam = call.parameters[&quot;id&quot;]&#10;            if (idParam == null){&#10;                call.respond(HttpStatusCode.BadRequest, mapOf(&quot;message&quot; to &quot;Missing id&quot;))&#10;                return@delete&#10;            }&#10;            val id = idParam.toIntOrNull()&#10;            if (id == null){&#10;                call.respond(HttpStatusCode.BadRequest, mapOf(&quot;message&quot; to &quot;Invalid id&quot;))&#10;                return@delete&#10;            }&#10;            try {&#10;                controller.delete(id)&#10;            }catch (e: SocialMediaNotFoundError){&#10;                call.respond(HttpStatusCode.NotFound, mapOf(&quot;message&quot; to e.toString()))&#10;            }&#10;        }&#10;    }&#10;}&#10;&#10;@Serializable&#10;private data class CreateSMRequest(&#10;    val id: Int,&#10;    val artistId: Int,&#10;    val url: String&#10;)&#10;&#10;@Serializable&#10;private data class EditSMRequest(&#10;    val id: Int,&#10;    val artistId: String,&#10;    val url: String&#10;)" />
              <option name="updatedContent" value="package com.adapp.backend.SocialMedia.Infrastructure.Routes&#10;&#10;import com.adapp.backend.SocialMedia.Domain.Exceptions.SocialMediaNotFoundError&#10;import com.adapp.backend.SocialMedia.Infrastructure.Controllers.KtorSocialMediaController&#10;import com.adapp.backend.SocialMedia.Infrastructure.Repositories.InMemorySocialMediaRepository&#10;import io.ktor.http.HttpStatusCode&#10;import io.ktor.server.application.Application&#10;import io.ktor.server.request.receive&#10;import io.ktor.server.response.respond&#10;import io.ktor.server.routing.delete&#10;import io.ktor.server.routing.get&#10;import io.ktor.server.routing.post&#10;import io.ktor.server.routing.put&#10;import io.ktor.server.routing.routing&#10;import kotlinx.serialization.Serializable&#10;import org.koin.ktor.ext.inject&#10;&#10;fun Application.configureRouting(){&#10;    // Inyectar repositorio usando Koin&#10;    val SMRepo: InMemorySocialMediaRepository by inject()&#10;    &#10;    val controller = KtorSocialMediaController(SMRepo)&#10;&#10;    routing {&#10;        get(&quot;/sm&quot;){&#10;            try {&#10;                val socialMedias = controller.getAll()&#10;                call.respond(socialMedias)&#10;            }catch (e:Exception){&#10;                call.application.environment.log.error(&quot;Error in GET /sm&quot;, e)&#10;                call.respond(HttpStatusCode.InternalServerError, mapOf(&quot;message&quot; to (e.message ?: &quot;&quot;)))&#10;            }&#10;        }&#10;&#10;        get(&quot;/sm/{id}&quot;){&#10;            val idParam = call.parameters[&quot;id&quot;]&#10;            if(idParam == null){&#10;                call.respond(HttpStatusCode.BadRequest, mapOf(&quot;message&quot; to &quot;Missing id&quot;))&#10;                return@get&#10;            }&#10;            val id = idParam.toIntOrNull()&#10;            if(id == null){&#10;                call.respond(HttpStatusCode.BadRequest, mapOf(&quot;message&quot; to &quot;Invalid id&quot;))&#10;                return@get&#10;            }&#10;&#10;            try{&#10;                val socialMedia = controller.getOneById(id)&#10;                call.respond(HttpStatusCode.OK, socialMedia)&#10;            }catch (e: SocialMediaNotFoundError){&#10;                call.respond(HttpStatusCode.NotFound, mapOf(&quot;message&quot; to e.toString()))&#10;            }&#10;        }&#10;&#10;        get(&quot;/socialMedia/artist/{artistId}/&quot;){&#10;            val artistIdParam = call.parameters[&quot;artistId&quot;]&#10;            if(artistIdParam == null){&#10;                call.respond(HttpStatusCode.BadRequest, mapOf(&quot;message&quot; to &quot;Missing artistId&quot;))&#10;                return@get&#10;            }&#10;            val artistId = artistIdParam.toIntOrNull()&#10;            if(artistId == null){&#10;                call.respond(HttpStatusCode.BadRequest, mapOf(&quot;message&quot; to &quot;Invalid artistId&quot;))&#10;                return@get&#10;            }&#10;&#10;            try{&#10;                val socialMedias = controller.getByArtistId(artistId)&#10;                call.respond(HttpStatusCode.OK, socialMedias)&#10;            }catch(e: Exception){&#10;                call.application.environment.log.error(&quot;Error in GET /socialMedia/artist/{artistId}/&quot;, e)&#10;                call.respond(HttpStatusCode.InternalServerError, mapOf(&quot;message&quot; to (e.message ?: &quot;&quot;)))&#10;            }&#10;        }&#10;&#10;        post(&quot;/sm/&quot;){&#10;            val payload = call.receive&lt;CreateSMRequest&gt;()&#10;            controller.create(payload.id, payload.artistId, payload.url)&#10;        }&#10;&#10;        put(&quot;/sm/{id}/&quot;){&#10;            val idParam = call.parameters[&quot;id&quot;]&#10;            if (idParam == null){&#10;                call.respond(HttpStatusCode.BadRequest, mapOf(&quot;message&quot; to &quot;Missing id&quot;))&#10;                return@put&#10;            }&#10;            val oldId = idParam.toIntOrNull()&#10;            if (oldId == null){&#10;                call.respond(HttpStatusCode.BadRequest, mapOf(&quot;message&quot; to &quot;Invalid id&quot;))&#10;                return@put&#10;            }&#10;            val payload = call.receive&lt;EditSMRequest&gt;()&#10;            try {&#10;                controller.edit(oldId, payload.id, payload.artistId.toInt(), payload.url)&#10;            }catch (e: SocialMediaNotFoundError){&#10;                call.respond(HttpStatusCode.NotFound, mapOf(&quot;message&quot; to e.toString()))&#10;            }catch (e: IllegalArgumentException){&#10;                call.respond(HttpStatusCode.Conflict, mapOf(&quot;message&quot; to e.message.toString()))&#10;            }&#10;        }&#10;&#10;        delete(&quot;/sm/{id}&quot;){&#10;            val idParam = call.parameters[&quot;id&quot;]&#10;            if (idParam == null){&#10;                call.respond(HttpStatusCode.BadRequest, mapOf(&quot;message&quot; to &quot;Missing id&quot;))&#10;                return@delete&#10;            }&#10;            val id = idParam.toIntOrNull()&#10;            if (id == null){&#10;                call.respond(HttpStatusCode.BadRequest, mapOf(&quot;message&quot; to &quot;Invalid id&quot;))&#10;                return@delete&#10;            }&#10;            try {&#10;                controller.delete(id)&#10;            }catch (e: SocialMediaNotFoundError){&#10;                call.respond(HttpStatusCode.NotFound, mapOf(&quot;message&quot; to e.toString()))&#10;            }&#10;        }&#10;    }&#10;}&#10;&#10;@Serializable&#10;private data class CreateSMRequest(&#10;    val id: Int,&#10;    val artistId: Int,&#10;    val url: String&#10;)&#10;&#10;@Serializable&#10;private data class EditSMRequest(&#10;    val id: Int,&#10;    val artistId: String,&#10;    val url: String&#10;)" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/AdApp-Backend/src/main/kotlin/com/adapp/backend/User/Infrastructure/Routes/KtorUserRouting.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/AdApp-Backend/src/main/kotlin/com/adapp/backend/User/Infrastructure/Routes/KtorUserRouting.kt" />
              <option name="originalContent" value="package com.adapp.backend.User.Infrastructure.Routes&#10;&#10;import com.adapp.backend.User.Infrastructure.Repositories.InMemoryUserRepository&#10;import com.adapp.backend.User.Infrastructure.Controllers.KtorUserController&#10;import com.adapp.backend.User.Domain.Exceptions.UserNotFoundError&#10;import com.adapp.backend.Artist.Infrastructure.Repositories.InMemoryArtistRepository&#10;import com.adapp.backend.Artist.Infrastructure.Controllers.KtorArtistController&#10;import io.ktor.http.*&#10;import io.ktor.server.application.*&#10;import io.ktor.server.routing.*&#10;import io.ktor.server.response.*&#10;import io.ktor.server.request.*&#10;import kotlinx.serialization.Serializable&#10;&#10;fun Application.configureRouting(&#10;    userRepo: InMemoryUserRepository,&#10;    artistRepo: InMemoryArtistRepository&#10;){&#10;    // Usar repositorios compartidos recibidos como parámetros&#10;    val controller = KtorUserController(userRepo)&#10;    val artistController = KtorArtistController(artistRepo)&#10;&#10;    // ContentNegotiation se instala en configureSerialization() a nivel de aplicación&#10;&#10;    routing {&#10;        // Register endpoint&#10;        post(&quot;/auth/register&quot;){&#10;            val registerData = call.receive&lt;RegisterRequest&gt;()&#10;            &#10;            // Verificar si el email ya existe&#10;            val allUsers = controller.getAll()&#10;            val existingUser = allUsers.find { it.correo == registerData.email }&#10;            &#10;            if(existingUser != null){&#10;                call.respond(HttpStatusCode.Conflict, mapOf(&quot;message&quot; to &quot;El correo ya está registrado&quot;))&#10;                return@post&#10;            }&#10;            &#10;            // Generar ID automáticamente&#10;            val newId = if(allUsers.isEmpty()) 1 else allUsers.maxOf { it.id } + 1&#10;            &#10;            // Crear usuario&#10;            controller.create(&#10;                id = newId,&#10;                name = registerData.username,&#10;                email = registerData.email,&#10;                passwd = registerData.password,&#10;                rol = registerData.userType&#10;            )&#10;&#10;            // Si es artista, también crear registro en artists&#10;            if (registerData.userType.equals(&quot;artist&quot;, ignoreCase = true)) {&#10;                // pasar fotoUrl y contactNum vacíos por ahora&#10;                artistController.create(&#10;                    newId,&#10;                    registerData.username,&#10;                    registerData.email,&#10;                    registerData.password,&#10;                    registerData.userType,&#10;                    &quot;&quot;,&#10;                    &quot;&quot;&#10;                )&#10;            }&#10;&#10;            // Generar token JWT (mock)&#10;            val token = &quot;mock-jwt-token-$newId&quot;&#10;            &#10;            val response = LoginResponse(&#10;                token = token,&#10;                user = UserData(&#10;                    id = newId,&#10;                    nombre = registerData.username,&#10;                    correo = registerData.email,&#10;                    rol = registerData.userType&#10;                )&#10;            )&#10;            &#10;            call.respond(HttpStatusCode.Created, response)&#10;        }&#10;&#10;        // Login endpoint&#10;        post(&quot;/auth/login&quot;){&#10;            val credentials = call.receive&lt;LoginRequest&gt;()&#10;            &#10;            // Buscar usuario por email&#10;            val allUsers = controller.getAll()&#10;            val user = allUsers.find { it.correo == credentials.email }&#10;            &#10;            if(user == null || user.contrasena != credentials.password){&#10;                call.respond(HttpStatusCode.Unauthorized, mapOf(&quot;message&quot; to &quot;Credenciales inválidas&quot;))&#10;                return@post&#10;            }&#10;            &#10;            // Generar token JWT (por ahora mock)&#10;            val token = &quot;mock-jwt-token-${user.id}&quot;&#10;            &#10;            val response = LoginResponse(&#10;                token = token,&#10;                user = UserData(&#10;                    id = user.id,&#10;                    nombre = user.nombre,&#10;                    correo = user.correo,&#10;                    rol = user.rol&#10;                )&#10;            )&#10;            &#10;            call.respond(response)&#10;        }&#10;&#10;        get(&quot;/users&quot;){&#10;            val users = controller.getAll()&#10;            call.respond(users)&#10;        }&#10;&#10;        get(&quot;/user/{id}/&quot;){&#10;            val idParam = call.parameters[&quot;id&quot;]&#10;            if(idParam == null){&#10;                call.respond(HttpStatusCode.BadRequest, mapOf(&quot;message&quot; to &quot;Missing id&quot;))&#10;                return@get&#10;            }&#10;            val id = idParam.toIntOrNull()&#10;            if(id == null){&#10;                call.respond(HttpStatusCode.BadRequest, mapOf(&quot;message&quot; to &quot;Invalid id&quot;))&#10;                return@get&#10;            }&#10;&#10;            try{&#10;                val user = controller.getOneById(id)&#10;                call.respond(user)&#10;            }catch(e: UserNotFoundError){&#10;                call.respond(HttpStatusCode.NotFound, mapOf(&quot;message&quot; to e.message))&#10;            }&#10;        }&#10;&#10;        post(&quot;/user/&quot;){&#10;            val payload = call.receive&lt;CreateUserRequest&gt;()&#10;            controller.create(&#10;                id = payload.id,&#10;                name = payload.name,&#10;                email = payload.email,&#10;                passwd = payload.password,&#10;                rol = payload.role&#10;            )&#10;            call.respond(HttpStatusCode.Created, mapOf(&quot;message&quot; to &quot;User created&quot;))&#10;        }&#10;&#10;        put(&quot;/user/{id}/&quot;){&#10;            val idParam = call.parameters[&quot;id&quot;]&#10;            if(idParam == null){&#10;                call.respond(HttpStatusCode.BadRequest, mapOf(&quot;message&quot; to &quot;Missing id&quot;))&#10;                return@put&#10;            }&#10;            val oldId = idParam.toIntOrNull()&#10;            if(oldId == null){&#10;                call.respond(HttpStatusCode.BadRequest, mapOf(&quot;message&quot; to &quot;Invalid id&quot;))&#10;                return@put&#10;            }&#10;&#10;            val payload = call.receive&lt;EditUserRequest&gt;()&#10;            try{&#10;                controller.edit(&#10;                    oldId = oldId,&#10;                    newId = payload.id,&#10;                    name = payload.name,&#10;                    email = payload.email,&#10;                    passwd = payload.password,&#10;                    rol = payload.role&#10;                )&#10;                call.respond(HttpStatusCode.NoContent)&#10;            }catch(e: UserNotFoundError){&#10;                call.respond(HttpStatusCode.NotFound, mapOf(&quot;message&quot; to e.message))&#10;            }catch(e: IllegalArgumentException){&#10;                call.respond(HttpStatusCode.BadRequest, mapOf(&quot;message&quot; to e.message))&#10;            }&#10;        }&#10;&#10;        delete(&quot;/user/{id}&quot;){&#10;            val idParam = call.parameters[&quot;id&quot;]&#10;            if(idParam == null){&#10;                call.respond(HttpStatusCode.BadRequest, mapOf(&quot;message&quot; to &quot;Missing id&quot;))&#10;                return@delete&#10;            }&#10;            val id = idParam.toIntOrNull()&#10;            if(id == null){&#10;                call.respond(HttpStatusCode.BadRequest, mapOf(&quot;message&quot; to &quot;Invalid id&quot;))&#10;                return@delete&#10;            }&#10;            try{&#10;                controller.delete(id)&#10;                call.respond(HttpStatusCode.NoContent)&#10;            }catch(e: UserNotFoundError){&#10;                call.respond(HttpStatusCode.NotFound, mapOf(&quot;message&quot; to e.message))&#10;            }&#10;        }&#10;    }&#10;}&#10;&#10;@Serializable&#10;private data class RegisterRequest(&#10;    val username: String,&#10;    val email: String,&#10;    val password: String,&#10;    val userType: String&#10;)&#10;&#10;@Serializable&#10;private data class LoginRequest(&#10;    val email: String,&#10;    val password: String&#10;)&#10;&#10;@Serializable&#10;private data class LoginResponse(&#10;    val token: String,&#10;    val user: UserData&#10;)&#10;&#10;@Serializable&#10;private data class UserData(&#10;    val id: Int,&#10;    val nombre: String,&#10;    val correo: String,&#10;    val rol: String&#10;)&#10;&#10;@Serializable&#10;private data class CreateUserRequest(&#10;    val id: Int,&#10;    val name: String,&#10;    val email: String,&#10;    val password: String,&#10;    val role: String&#10;)&#10;&#10;@Serializable&#10;private data class EditUserRequest(&#10;    val id: Int,&#10;    val name: String,&#10;    val email: String,&#10;    val password: String,&#10;    val role: String&#10;)&#10;" />
              <option name="updatedContent" value="package com.adapp.backend.User.Infrastructure.Routes&#10;&#10;import com.adapp.backend.User.Infrastructure.Repositories.InMemoryUserRepository&#10;import com.adapp.backend.User.Infrastructure.Controllers.KtorUserController&#10;import com.adapp.backend.User.Domain.Exceptions.UserNotFoundError&#10;import com.adapp.backend.Artist.Infrastructure.Repositories.InMemoryArtistRepository&#10;import com.adapp.backend.Artist.Infrastructure.Controllers.KtorArtistController&#10;import io.ktor.http.*&#10;import io.ktor.server.application.*&#10;import io.ktor.server.routing.*&#10;import io.ktor.server.response.*&#10;import io.ktor.server.request.*&#10;import kotlinx.serialization.Serializable&#10;import org.koin.ktor.ext.inject&#10;&#10;fun Application.configureRouting(){&#10;    // Inyectar repositorios usando Koin&#10;    val userRepo: InMemoryUserRepository by inject()&#10;    val artistRepo: InMemoryArtistRepository by inject()&#10;    &#10;    val controller = KtorUserController(userRepo)&#10;    val artistController = KtorArtistController(artistRepo)&#10;&#10;    // ContentNegotiation se instala en configureSerialization() a nivel de aplicación&#10;&#10;    routing {&#10;        // Register endpoint&#10;        post(&quot;/auth/register&quot;){&#10;            val registerData = call.receive&lt;RegisterRequest&gt;()&#10;            &#10;            // Verificar si el email ya existe&#10;            val allUsers = controller.getAll()&#10;            val existingUser = allUsers.find { it.correo == registerData.email }&#10;            &#10;            if(existingUser != null){&#10;                call.respond(HttpStatusCode.Conflict, mapOf(&quot;message&quot; to &quot;El correo ya está registrado&quot;))&#10;                return@post&#10;            }&#10;            &#10;            // Generar ID automáticamente&#10;            val newId = if(allUsers.isEmpty()) 1 else allUsers.maxOf { it.id } + 1&#10;            &#10;            // Crear usuario&#10;            controller.create(&#10;                id = newId,&#10;                name = registerData.username,&#10;                email = registerData.email,&#10;                passwd = registerData.password,&#10;                rol = registerData.userType&#10;            )&#10;&#10;            // Si es artista, también crear registro en artists&#10;            if (registerData.userType.equals(&quot;artist&quot;, ignoreCase = true)) {&#10;                // pasar fotoUrl y contactNum vacíos por ahora&#10;                artistController.create(&#10;                    newId,&#10;                    registerData.username,&#10;                    registerData.email,&#10;                    registerData.password,&#10;                    registerData.userType,&#10;                    &quot;&quot;,&#10;                    &quot;&quot;&#10;                )&#10;            }&#10;&#10;            // Generar token JWT (mock)&#10;            val token = &quot;mock-jwt-token-$newId&quot;&#10;            &#10;            val response = LoginResponse(&#10;                token = token,&#10;                user = UserData(&#10;                    id = newId,&#10;                    nombre = registerData.username,&#10;                    correo = registerData.email,&#10;                    rol = registerData.userType&#10;                )&#10;            )&#10;            &#10;            call.respond(HttpStatusCode.Created, response)&#10;        }&#10;&#10;        // Login endpoint&#10;        post(&quot;/auth/login&quot;){&#10;            val credentials = call.receive&lt;LoginRequest&gt;()&#10;            &#10;            // Buscar usuario por email&#10;            val allUsers = controller.getAll()&#10;            val user = allUsers.find { it.correo == credentials.email }&#10;            &#10;            if(user == null || user.contrasena != credentials.password){&#10;                call.respond(HttpStatusCode.Unauthorized, mapOf(&quot;message&quot; to &quot;Credenciales inválidas&quot;))&#10;                return@post&#10;            }&#10;            &#10;            // Generar token JWT (por ahora mock)&#10;            val token = &quot;mock-jwt-token-${user.id}&quot;&#10;            &#10;            val response = LoginResponse(&#10;                token = token,&#10;                user = UserData(&#10;                    id = user.id,&#10;                    nombre = user.nombre,&#10;                    correo = user.correo,&#10;                    rol = user.rol&#10;                )&#10;            )&#10;            &#10;            call.respond(response)&#10;        }&#10;&#10;        get(&quot;/users&quot;){&#10;            val users = controller.getAll()&#10;            call.respond(users)&#10;        }&#10;&#10;        get(&quot;/user/{id}/&quot;){&#10;            val idParam = call.parameters[&quot;id&quot;]&#10;            if(idParam == null){&#10;                call.respond(HttpStatusCode.BadRequest, mapOf(&quot;message&quot; to &quot;Missing id&quot;))&#10;                return@get&#10;            }&#10;            val id = idParam.toIntOrNull()&#10;            if(id == null){&#10;                call.respond(HttpStatusCode.BadRequest, mapOf(&quot;message&quot; to &quot;Invalid id&quot;))&#10;                return@get&#10;            }&#10;&#10;            try{&#10;                val user = controller.getOneById(id)&#10;                call.respond(user)&#10;            }catch(e: UserNotFoundError){&#10;                call.respond(HttpStatusCode.NotFound, mapOf(&quot;message&quot; to e.message))&#10;            }&#10;        }&#10;&#10;        post(&quot;/user/&quot;){&#10;            val payload = call.receive&lt;CreateUserRequest&gt;()&#10;            controller.create(&#10;                id = payload.id,&#10;                name = payload.name,&#10;                email = payload.email,&#10;                passwd = payload.password,&#10;                rol = payload.role&#10;            )&#10;            call.respond(HttpStatusCode.Created, mapOf(&quot;message&quot; to &quot;User created&quot;))&#10;        }&#10;&#10;        put(&quot;/user/{id}/&quot;){&#10;            val idParam = call.parameters[&quot;id&quot;]&#10;            if(idParam == null){&#10;                call.respond(HttpStatusCode.BadRequest, mapOf(&quot;message&quot; to &quot;Missing id&quot;))&#10;                return@put&#10;            }&#10;            val oldId = idParam.toIntOrNull()&#10;            if(oldId == null){&#10;                call.respond(HttpStatusCode.BadRequest, mapOf(&quot;message&quot; to &quot;Invalid id&quot;))&#10;                return@put&#10;            }&#10;&#10;            val payload = call.receive&lt;EditUserRequest&gt;()&#10;            try{&#10;                controller.edit(&#10;                    oldId = oldId,&#10;                    newId = payload.id,&#10;                    name = payload.name,&#10;                    email = payload.email,&#10;                    passwd = payload.password,&#10;                    rol = payload.role&#10;                )&#10;                call.respond(HttpStatusCode.NoContent)&#10;            }catch(e: UserNotFoundError){&#10;                call.respond(HttpStatusCode.NotFound, mapOf(&quot;message&quot; to e.message))&#10;            }catch(e: IllegalArgumentException){&#10;                call.respond(HttpStatusCode.BadRequest, mapOf(&quot;message&quot; to e.message))&#10;            }&#10;        }&#10;&#10;        delete(&quot;/user/{id}&quot;){&#10;            val idParam = call.parameters[&quot;id&quot;]&#10;            if(idParam == null){&#10;                call.respond(HttpStatusCode.BadRequest, mapOf(&quot;message&quot; to &quot;Missing id&quot;))&#10;                return@delete&#10;            }&#10;            val id = idParam.toIntOrNull()&#10;            if(id == null){&#10;                call.respond(HttpStatusCode.BadRequest, mapOf(&quot;message&quot; to &quot;Invalid id&quot;))&#10;                return@delete&#10;            }&#10;            try{&#10;                controller.delete(id)&#10;                call.respond(HttpStatusCode.NoContent)&#10;            }catch(e: UserNotFoundError){&#10;                call.respond(HttpStatusCode.NotFound, mapOf(&quot;message&quot; to e.message))&#10;            }&#10;        }&#10;    }&#10;}&#10;&#10;@Serializable&#10;private data class RegisterRequest(&#10;    val username: String,&#10;    val email: String,&#10;    val password: String,&#10;    val userType: String&#10;)&#10;&#10;@Serializable&#10;private data class LoginRequest(&#10;    val email: String,&#10;    val password: String&#10;)&#10;&#10;@Serializable&#10;private data class LoginResponse(&#10;    val token: String,&#10;    val user: UserData&#10;)&#10;&#10;@Serializable&#10;private data class UserData(&#10;    val id: Int,&#10;    val nombre: String,&#10;    val correo: String,&#10;    val rol: String&#10;)&#10;&#10;@Serializable&#10;private data class CreateUserRequest(&#10;    val id: Int,&#10;    val name: String,&#10;    val email: String,&#10;    val password: String,&#10;    val role: String&#10;)&#10;&#10;@Serializable&#10;private data class EditUserRequest(&#10;    val id: Int,&#10;    val name: String,&#10;    val email: String,&#10;    val password: String,&#10;    val role: String&#10;)&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>