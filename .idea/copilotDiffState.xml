<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/AdApp-Backend/bin/main/com/adapp/backend/Application.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/AdApp-Backend/bin/main/com/adapp/backend/Application.kt" />
              <option name="originalContent" value="package com.adapp.backend&#10;&#10;import com.adapp.examples.configureDatabases&#10;import com.adapp.examples.configureFrameworks&#10;import com.adapp.examples.configureRouting&#10;import com.adapp.examples.configureSecurity&#10;import com.adapp.examples.configureSerialization&#10;import com.adapp.backend.User.Infrastructure.Routes.configureRouting as configureUserRouting&#10;import io.ktor.server.application.*&#10;import io.ktor.server.cio.EngineMain&#10;&#10;fun main(args: Array&lt;String&gt;) {&#10;    // Set properties to avoid netty-specific warnings if any netty jars remain&#10;    System.setProperty(&quot;io.netty.noUnsafe&quot;, &quot;true&quot;)&#10;    System.setProperty(&quot;io.netty.tryReflectionSetAccessible&quot;, &quot;false&quot;)&#10;    EngineMain.main(args)&#10;}&#10;&#10;fun Application.module() {&#10;    configureSecurity()&#10;    configureFrameworks()&#10;    configureSerialization()&#10;    configureDatabases()&#10;    configureRouting()&#10;    configureUserRouting()&#10;}" />
              <option name="updatedContent" value="package com.adapp.backend&#13;&#10;&#13;&#10;import com.adapp.examples.configureDatabases&#13;&#10;import com.adapp.examples.configureFrameworks&#13;&#10;import com.adapp.examples.configureRouting&#13;&#10;import com.adapp.examples.configureSecurity&#13;&#10;import com.adapp.examples.configureSerialization&#13;&#10;import com.adapp.backend.User.Infrastructure.Routes.configureRouting as configureUserRouting&#13;&#10;import com.adapp.backend.Artist.Infrastructure.Routes.configureArtistRouting as configureArtistRouting&#13;&#10;import io.ktor.server.application.*&#13;&#10;import io.ktor.server.cio.EngineMain&#13;&#10;&#13;&#10;fun main(args: Array&lt;String&gt;) {&#13;&#10;    // Set properties to avoid netty-specific warnings if any netty jars remain&#13;&#10;    System.setProperty(&quot;io.netty.noUnsafe&quot;, &quot;true&quot;)&#13;&#10;    System.setProperty(&quot;io.netty.tryReflectionSetAccessible&quot;, &quot;false&quot;)&#13;&#10;    EngineMain.main(args)&#13;&#10;}&#13;&#10;&#13;&#10;fun Application.module() {&#13;&#10;    configureSecurity()&#13;&#10;    configureFrameworks()&#13;&#10;    configureSerialization()&#13;&#10;    configureDatabases()&#13;&#10;    configureRouting()&#13;&#10;    configureUserRouting()&#13;&#10;    configureArtistRouting()&#13;&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/AdApp-Backend/src/main/kotlin/com/adapp/backend/User/Infrastructure/Controllers/KtorUserController.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/AdApp-Backend/src/main/kotlin/com/adapp/backend/User/Infrastructure/Controllers/KtorUserController.kt" />
              <option name="originalContent" value="package com.adapp.backend.User.Infrastructure.Controllers&#10;&#10;import com.adapp.backend.User.Domain.Models.User&#10;import com.adapp.backend.User.Domain.Models.UserId&#10;import com.adapp.backend.User.Domain.Repositories.UserRepository&#10;import com.adapp.backend.User.Domain.Exceptions.UserNotFoundError&#10;import com.adapp.backend.User.Domain.Models.UserEmail&#10;import com.adapp.backend.User.Domain.Models.UserName&#10;import com.adapp.backend.User.Domain.Models.UserPsswd&#10;import com.adapp.backend.User.Domain.Models.UserRol&#10;&#10;class KtorUserController(private val userRepo: UserRepository) {&#10;&#10;    fun getAll(): List&lt;Map&lt;String, Any&gt;&gt; {&#10;        return userRepo.getAllUsers().map { it.mapToPrimitives() }&#10;    }&#10;&#10;    fun getOneById(id: Int): Map&lt;String, Any&gt; {&#10;        val user = userRepo.getOneById(UserId(id)) ?: throw UserNotFoundError(&quot;User not found&quot;)&#10;        return user.mapToPrimitives()&#10;    }&#10;&#10;    fun create(id: Int, name: String, email: String, passwd: String, rol: String) {&#10;        val user = User(&#10;            UserId(id),&#10;            UserName(name),&#10;            UserEmail(email),&#10;            UserPsswd(passwd),&#10;            UserRol(rol)&#10;        )&#10;        userRepo.create(user)&#10;    }&#10;&#10;    /**&#10;     * Edita un usuario. Si `newId` != `oldId` crea uno nuevo y borra el antiguo; lanza IllegalArgumentException si newId ya existe.&#10;     */&#10;    fun edit(oldId: Int, newId: Int, name: String, email: String, passwd: String, rol: String) {&#10;        userRepo.getOneById(UserId(oldId)) ?: throw UserNotFoundError(&quot;User not found&quot;)&#10;&#10;        if (oldId != newId) {&#10;            val conflict = userRepo.getOneById(UserId(newId))&#10;            if (conflict != null) throw IllegalArgumentException(&quot;User with id $newId already exists&quot;)&#10;&#10;            val created = User(&#10;                UserId(newId),&#10;                UserName(name),&#10;                UserEmail(email),&#10;                UserPsswd(passwd),&#10;                UserRol(rol)&#10;            )&#10;            userRepo.create(created)&#10;            userRepo.delete(UserId(oldId))&#10;            return&#10;        }&#10;&#10;        val updated = User(&#10;            UserId(oldId),&#10;            UserName(name),&#10;            UserEmail(email),&#10;            UserPsswd(passwd),&#10;            UserRol(rol)&#10;        )&#10;        userRepo.edit(updated)&#10;    }&#10;&#10;    fun delete(id: Int) {&#10;        userRepo.getOneById(UserId(id)) ?: throw UserNotFoundError(&quot;User not found&quot;)&#10;        userRepo.delete(UserId(id))&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package com.adapp.backend.User.Infrastructure.Controllers&#13;&#10;&#13;&#10;import com.adapp.backend.User.Domain.Models.User&#13;&#10;import com.adapp.backend.User.Domain.Models.UserId&#13;&#10;import com.adapp.backend.User.Domain.Models.UserDTO&#13;&#10;import com.adapp.backend.User.Domain.Repositories.UserRepository&#13;&#10;import com.adapp.backend.User.Domain.Exceptions.UserNotFoundError&#13;&#10;import com.adapp.backend.User.Domain.Models.UserEmail&#13;&#10;import com.adapp.backend.User.Domain.Models.UserName&#13;&#10;import com.adapp.backend.User.Domain.Models.UserPsswd&#13;&#10;import com.adapp.backend.User.Domain.Models.UserRol&#13;&#10;&#13;&#10;class KtorUserController(private val userRepo: UserRepository) {&#13;&#10;&#13;&#10;    fun getAll(): List&lt;UserDTO&gt; {&#13;&#10;        return userRepo.getAllUsers().map { user -&gt;&#13;&#10;            UserDTO(&#13;&#10;                id = user.Usuarioid.value,&#13;&#10;                nombre = user.nombre.value,&#13;&#10;                correo = user.correo.value,&#13;&#10;                contrasena = user.contrasena.value,&#13;&#10;                rol = user.rol.value&#13;&#10;            )&#13;&#10;        }&#13;&#10;    }&#13;&#10;&#13;&#10;    fun getOneById(id: Int): UserDTO {&#13;&#10;        val user = userRepo.getOneById(UserId(id)) ?: throw UserNotFoundError(&quot;User not found&quot;)&#13;&#10;        return UserDTO(&#13;&#10;            id = user.Usuarioid.value,&#13;&#10;            nombre = user.nombre.value,&#13;&#10;            correo = user.correo.value,&#13;&#10;            contrasena = user.contrasena.value,&#13;&#10;            rol = user.rol.value&#13;&#10;        )&#13;&#10;    }&#13;&#10;&#13;&#10;    fun create(id: Int, name: String, email: String, passwd: String, rol: String) {&#13;&#10;        val user = User(&#13;&#10;            UserId(id),&#13;&#10;            UserName(name),&#13;&#10;            UserEmail(email),&#13;&#10;            UserPsswd(passwd),&#13;&#10;            UserRol(rol)&#13;&#10;        )&#13;&#10;        userRepo.create(user)&#13;&#10;    }&#13;&#10;&#13;&#10;    /**&#13;&#10;     * Edita un usuario. Si `newId` != `oldId` crea uno nuevo y borra el antiguo; lanza IllegalArgumentException si newId ya existe.&#13;&#10;     */&#13;&#10;    fun edit(oldId: Int, newId: Int, name: String, email: String, passwd: String, rol: String) {&#13;&#10;        userRepo.getOneById(UserId(oldId)) ?: throw UserNotFoundError(&quot;User not found&quot;)&#13;&#10;&#13;&#10;        if (oldId != newId) {&#13;&#10;            val conflict = userRepo.getOneById(UserId(newId))&#13;&#10;            if (conflict != null) throw IllegalArgumentException(&quot;User with id $newId already exists&quot;)&#13;&#10;&#13;&#10;            val created = User(&#13;&#10;                UserId(newId),&#13;&#10;                UserName(name),&#13;&#10;                UserEmail(email),&#13;&#10;                UserPsswd(passwd),&#13;&#10;                UserRol(rol)&#13;&#10;            )&#13;&#10;            userRepo.create(created)&#13;&#10;            userRepo.delete(UserId(oldId))&#13;&#10;            return&#13;&#10;        }&#13;&#10;&#13;&#10;        val updated = User(&#13;&#10;            UserId(oldId),&#13;&#10;            UserName(name),&#13;&#10;            UserEmail(email),&#13;&#10;            UserPsswd(passwd),&#13;&#10;            UserRol(rol)&#13;&#10;        )&#13;&#10;        userRepo.edit(updated)&#13;&#10;    }&#13;&#10;&#13;&#10;    fun delete(id: Int) {&#13;&#10;        userRepo.getOneById(UserId(id)) ?: throw UserNotFoundError(&quot;User not found&quot;)&#13;&#10;        userRepo.delete(UserId(id))&#13;&#10;    }&#13;&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>